document.addEventListener('DOMContentLoaded', function() {
    initializeSnowEffect();
    initializeMuzzleFlashes();
    initializeTVStatic();
    initializeTrackMenu();
    initializeCustomPlayer();
    initializeMobileMenu();
    loadTrack(tracks[2]);
});

// МОБИЛЬНОЕ МЕНЮ
function initializeMobileMenu() {
    const menuBtn = document.getElementById('mobile-menu-btn');
    const closeBtn = document.getElementById('close-menu-btn');
    const menu = document.getElementById('track-menu');

    if (menuBtn && menu) {
        menuBtn.addEventListener('click', function() {
            menu.classList.add('menu-open');
        });
    }

    if (closeBtn) closeBtn.addEventListener('click', closeMenu);

    function closeMenu() {
        if (menu) menu.classList.remove('menu-open');
    }
}

// ПЛЕЕР-
function initializeCustomPlayer() {
    const audioPlayer = document.getElementById('track-player');
    const playBtn = document.getElementById('play-btn');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const progressBar = document.getElementById('progress-bar');
    const currentTimeEl = document.getElementById('current-time');
    const durationEl = document.getElementById('duration');
    const volumeBar = document.getElementById('volume-bar');
    
    playBtn.addEventListener('click', togglePlay);
    prevBtn.addEventListener('click', playPrevTrack);
    nextBtn.addEventListener('click', playNextTrack);
    
    progressBar.addEventListener('input', function() {
        if (audioPlayer.duration) audioPlayer.currentTime = this.value;
    });
    
    let isSeeking = false;
    progressBar.addEventListener('mousedown', () => isSeeking = true);
    progressBar.addEventListener('touchstart', () => isSeeking = true, {passive: true});
    progressBar.addEventListener('mouseup', () => isSeeking = false);
    progressBar.addEventListener('touchend', () => isSeeking = false);
    
    volumeBar.addEventListener('input', function() { audioPlayer.volume = this.value; });
    
    audioPlayer.addEventListener('timeupdate', updateProgress);
    audioPlayer.addEventListener('loadedmetadata', updateDuration);
    audioPlayer.addEventListener('ended', function() {
        audioPlayer.currentTime = 0;
        resetProgressBar();
        playNextTrack();
    });
    audioPlayer.addEventListener('play', () => playBtn.classList.add('playing'));
    audioPlayer.addEventListener('pause', () => playBtn.classList.remove('playing'));
    
    function togglePlay() {
        if (audioPlayer.paused) audioPlayer.play(); else audioPlayer.pause();
    }
    
    function updateProgress() {
        if (!isSeeking && audioPlayer.duration) {
            progressBar.value = audioPlayer.currentTime;
            currentTimeEl.textContent = formatTime(audioPlayer.currentTime);
        }
    }
    
    function updateDuration() {
        if (audioPlayer.duration) {
            durationEl.textContent = formatTime(audioPlayer.duration);
            progressBar.max = audioPlayer.duration;
        }
    }
    
    function formatTime(seconds) {
        if (isNaN(seconds)) return '0:00';
        const min = Math.floor(seconds / 60);
        const sec = Math.floor(seconds % 60);
        return `${min}:${sec < 10 ? '0' : ''}${sec}`;
    }
    
    function playNextTrack() {
        const menuOrder = ['track3', 'track1', 'track2', 'track4', 'track5', 'track6', 'track7', 'track8'];
        const currentId = getCurrentTrackId();
        const idx = menuOrder.indexOf(currentId);
        if (idx !== -1) {
            const nextId = menuOrder[(idx + 1) % menuOrder.length];
            const nextTrack = tracks.find(t => t.id === nextId);
            if (nextTrack) { loadTrack(nextTrack); setTimeout(() => audioPlayer.play(), 100); }
        }
    }
    
    function playPrevTrack() {
        const menuOrder = ['track3', 'track1', 'track2', 'track4', 'track5', 'track6', 'track7', 'track8'];
        const currentId = getCurrentTrackId();
        const idx = menuOrder.indexOf(currentId);
        if (idx !== -1) {
            const prevId = menuOrder[(idx - 1 + menuOrder.length) % menuOrder.length];
            const prevTrack = tracks.find(t => t.id === prevId);
            if (prevTrack) { loadTrack(prevTrack); setTimeout(() => audioPlayer.play(), 100); }
        }
    }
    
    function getCurrentTrackId() {
        const src = audioPlayer.src;
        const parts = src.split('/');
        return parts[parts.length - 1].replace('.mp3', '').split('?')[0];
    }
}

function resetProgressBar() {
    const progressBar = document.getElementById('progress-bar');
    const currentTimeEl = document.getElementById('current-time');
    if (progressBar) progressBar.value = 0;
    if (currentTimeEl) currentTimeEl.textContent = '0:00';
}

// ОПИСАНИЕ АЛЬБОМА (ПОЛНЫЙ ТЕКСТ)
function showAlbumDescription() {
    const menu = document.getElementById('track-menu');
    if (menu) menu.classList.remove('menu-open');

    const popup = document.createElement('div');
    popup.classList.add('album-description-popup');
    
    // ПОЛНЫЙ ТЕКСТ ВОЗВРАЩЕН
    const content = `
# I. Глобальная концепция и Сюжетная арка: Траектория Падения

### Центральный тезис:

Альбом **«Жизнь»** — это онтологический хоррор, аудиальный роман-антиутопия, сотканный из нервных окончаний, битого стекла и культурных обломков эпохи метамодерна. Это хроника распада личности, помещенной в центрифугу истории. Философское ядро альбома утверждает: существование в современном мире — это процесс неизбежной, механистической дегуманизации. Жизнь здесь подается не как дар, а как авария, растянутая во времени.

Весь релиз — это документация того, как живая, чувствующая материя («мясо», «дерево») перерабатывается Системой в функцию («вольфрам», «курсор»), а затем утилизируется как отход («пепел», «человек за бортом»).

### Траектория Лирического Героя:

Это путь обратной эволюции:
*   **Рождение («Жизнь»):** Герой появляется в мире как жертва обстоятельств. Он ещё чувствует боль, он ещё видит «кривизну лиц». Это стадия Страдания.
*   **Инициация («Вольно», «Ангел жизни»):** Герой попадает в жернова. Его отесывают («столяр»), ему дают в руки оружие. Он пытается рационализировать насилие, прикрываясь высокими целями («Тетраграмматон»). Это стадия Действия и Отрицания.
*   **Надлом («Вольфрам»):** Пик напряжения. Психика не выдерживает («пружинка вольфрама»). Герой превращается в оголенный нерв. Это стадия Травмы.
*   **Распад («Тест на репликанта», «Немота»):** Внутренний и внешний конфликт. Герой теряет способность различать «своих» и «чужих», теряет дар речи. Он проваливает тест на человечность. Это стадия Отчуждения.
*   **Финал («Авада Кедавра», «Man Overboard»):** Полный цинизм и эскапизм, заканчивающийся физической гибелью. Герой становится «пьяным водителем» собственной судьбы, вылетающим на встречную полосу. Это стадия Смерти.

---

# II. Архитектура треклиста: От Колыбели до Могилы

Порядок треков выстроен по принципу замыкающегося круга Сансары, из которого нет выхода, кроме как «за борт».

*   **Начало («Жизнь»):** Альбом открывается «мрачной колыбельной». Образ «тел, стукающихся о лобовые стекла» в первом треке — это чеховское ружье, которое выстрелит в последнем треке.
*   **Середина (Мясорубка):** Блок треков от **«Вольно»** до **«Вольфрама»** — это зона активных боевых действий (внешних и внутренних). Музыка становится агрессивной, индустриальной.
*   **Слом («Тест на репликанта» — «Немота»):** Здесь ритм замедляется, становится вязким. Это «похмелье» после битвы, осознание тупика.
*   **Конец («Man Overboard»):** Альбом заканчивается тем, чем начался — автокатастрофой. «Unplanned crash undertaking» в финале — это реализация метафоры из первого трека. Круг замкнулся.

### Смысловые мостики:
*   **Тема Игры:** «Игра в города» (Вольно) -> «Шутер коридорный» (Ангел) -> «Жизнь — игра / Жизнь — игрушки» (Авада Кедавра). Война и жизнь воспринимаются как геймплей, где смерть не реальна до самого конца.
*   **Холод и Огонь:** Герой постоянно мерзнет («уснувший ад», «на холостом ходу»), пытаясь согреться огнем разрушения («пепел черный», «пламя рыжее»).
*   **Механистичность:** «Эквалайзер» -> «Рация» -> «Вольфрам» -> «Дырокол» -> «Курсор». Человек постепенно заменяется набором запчастей.

---

# III. Система образов: Анатомия Расчеловечивания

### 1. Дегуманизация (Человек-Вещь):
Автор виртуозно работает с овеществлением. В начале герой — это «дерево», которое строгает столяр (Вольно). Затем он становится «пружинкой вольфрама» в лампе (Вольфрам), функцией, которая обязана светить, пока не перегорит. В Авада Кедавра он уже просто «курсор мыши», распятый на экране. В финале он — «груз», падающий за борт. Душа исчезает, остается только функционал.

### 2. Война и Мир:
Война здесь показана как тотальное состояние бытия.
Это не только окопы («Вольфрам»), но и городские протесты («Тест на репликанта»), и внутренняя борьба с депрессией («Жизнь»).
Используется образ «бойни» и «мукомольни». Война — это производство, где сырьем служат люди («кости на мукомольню», «баланда в миске»).
Сатира на милитаризм: «Броневик — не бронепоезд», «С днем рожденья, Хиросима».

### 3. Религия и Богоборчество:
Бог в альбоме — это Командир.
*   В **Вольно**: «Бог мне не судья» (отказ от юрисдикции небес).
*   В **Ангеле жизни**: «Тетраграмматон прекрасен» — Бог как генерал, отдающий приказ на уничтожение.
*   В **Авада Кедавра**: Самый мощный образ — «Евангелист-пулеметчик». Евангелие (Благая весть) доносится с частотой выстрелов пулемета. Религия слилась с насилием.

---

# IV. Интертекстуальность: Культурный Шизофренизм

Автор создает эффект клипового сознания, смешивая высокое и низкое. Это не просто эрудиция, это способ показать, как в голове современного человека «Божественная комедия» Данте соседствует с летсплеем по Minecraft.

*   **Классика:** Юнг («Вольфрам», «Авада Кедавра»), «Слово о полку Игореве» («Тест на репликанта»), Бодлер («Сплин» в «Man Overboard»), Буриданов осел («Немота»).
*   **Поп-культура:** Гарри Поттер («Волан-де-Морт», «Авада Кедавра», «Карта мародеров»), Бегущий по лезвию («Тест на репликанта»), Джейсон Борн, Казино Рояль («Ле Шифр»).
*   **Видеоигры:** Doom, Skyrim, Assassin’s Creed («Прыжок веры между стогами»).
*   **Улица и Зона:** Тюремный жаргон («шомпол», «пика», «баланда», «палишь»), эстетика подворотни.

**Эффект:** Этот коктейль создает ощущение сюрреалистического кошмара. Герой пытается осмыслить ужас войны через образы видеоигр («шутер коридорный»), потому что реальность слишком страшна, чтобы воспринимать её напрямую. Это защитный механизм психики.

---

# V. Психологический портрет: Диагноз

Лирический герой — **«Потерянный солдат Постмодерна»**.
*   **Диагноз:** Тяжелая форма ПТСР, осложненная диссоциативным расстройством и алкогольной зависимостью.
*   **Характеристика:** Он циник поневоле. Изначально это человек тонкой душевной организации, которого заставили стать мясником.
*   **Конфликт:** Его трагедия в том, что он всё понимает. Он видит абсурдность приказов («пять третьих лени»), пошлость пропаганды («порт Скайрима»), но продолжает выполнять функцию, потому что «время вставать». Он — интеллектуальный наемник, который презирает своих нанимателей, но еще больше презирает себя.

---

# VI. Скрытые детали и "Пасхалки"

*   **Лингвистическая смерть:** Альбом начинается на богатом русском языке с изысканными метафорами, проходит через сленг и мат, а заканчивается на ломаном английском (Man Overboard). Это символизирует полную потерю идентичности и отчуждение от родной культуры/языка, который стал языком насилия.
*   **Игровая механика смерти:** В Немоте обыгрывается «прыжок веры» из Assassin’s Creed. В игре прыжок в сено спасает. Герой прыгает между стогами. Он знает правила игры и намеренно нарушает их, чтобы умереть.
*   **Цветовая кодировка:**
    *   **Красный:** Агрессия, жизнь («красная тряпка», «струйки красной»).
    *   **Желтый/Рыжий:** Безумие, огонь («пламя рыжее», «карлик желтый»).
    *   **Зеленый:** Ложная надежда, смерть («Green light» в финале — свет Гэтсби или выход в небытие).
    *   **Вольфрамовый/Белый:** Накал боли.
*   **Звук:** Постоянное присутствие «скрежета» и «звона» в текстах (фонетика) подготавливает слушателя к финальному удару металла о металл в автокатастрофе.

### Семантическая паутина «МОР — МОРОК — МОРГ — МОРДОР»

**Морок** – это ключевой маркер состояния реальности в альбоме. Оно эволюционирует от психологического состояния к физическому месту.

1.  **«Вольфрам»:** _«Я ниже, пью морок и мрак / В неуютной глотке судьбы»._
    Здесь морок — это жидкая субстанция, которую герой пьет. Это яд пропаганды или алкоголь, затуманивающий сознание в окопе.
2.  **«Немота»:** _«Отойди морок. Это не морг... На дворе мордор и Волан-Де-Морт»._
    Здесь происходит фонетический взрыв. Звук [мор] становится доминирующим. Автор показывает, что границы между наваждением (морок), смертью (морг) и тоталитарной реальностью (Мордор) стерты. Одно слово перетекает в другое, создавая ловушку сознания.
3.  **«Авада Кедавра»:** _«Морок не растолкованных снов»._
    Здесь круг замыкается. Морок становится клиническим диагнозом, который лечат «кофе и ИВЛ».
4.  **«Авада Кедавра» (Outro):** _«В крутящем memento mori»._
    Финальная трансформация звука [мор]. Наваждение (морок) превращается в память о смерти (memento mori).

**Вывод:** Реальность альбома зыбка. Герой не может понять, где заканчивается кошмарный сон (морок) и начинается физическая смерть (морг).

### Сон и Пробуждение (Матричный мотив)

Мотив сна пронизывает альбом, но пробуждение здесь страшнее кошмара.
*   **«Жизнь»:** Альбом начинается как колыбельная («Скачком эквалайзера будит соседей», «Пожелают крепкого сна»). Смерть подается как сон.
*   **«Вольфрам»:** Рефрен «Время вставать!». Это не призыв к действию, это принуждение. Герой хочет «спать» (умереть/отключиться), но война/долг заставляют его «встать» и быть функцией.
*   **«Ангел жизни»:** «Шофер слегка уснул». Сон как ошибка, ведущая к катастрофе.
*   **«Тест на репликанта»:** «В спящем Игоревом полку». Сон общества, которое не видит катастрофы.
*   **«Авада Кедавра»:** «Садит на кофе... Морок не растолкованных снов». Искусственное поддержание бодрствования, чтобы продолжать страдать.

### Деградация Речи: От Слова к Немоте

Показан процесс утраты способности говорить и быть человеком.
*   **«Вольно»:** «С частотой слОва хрипит рацио», «Моя словесная руда». Герой еще верит в силу слова, он говорит много, сложно, витиевато (spoken word).
*   **«Тест на репликанта»:** Речь становится рваной, переходит в крик («Хором глотка не орала»), сбивается на хрип рации.
*   **«Немота»:** Полный отказ речевого аппарата. «Рта врата мысли бодают / Не могу сказать ни слога». Герой теряет дар речи от ужаса («Немота — мой новый слоган»).
*   **«Man Overboard»:** Язык меняется на чужой (английский). Это символ полного отчуждения. Герой забыл родной язык или он больше не может на нем выразить боль. Речь становится ломаной («Broken English»), примитивной.

### Эволюция «Игры» (Геймификация насилия)

Герой пытается защититься от ужаса реальности, превращая её в видеоигру. Но жанр игры постоянно меняется, становясь всё мрачнее.
*   **Детская стратегия («Вольно»):** «Я поиграю в города».
    Война воспринимается как игра в названия, но суть игры меняется: вместо называния городов их стирают с лица земли («раскрасит градом белым розы»).
*   **Шутер («Ангел жизни»):** «Шутер вполне коридорный», «Сюжет — рудимент для порно».
    Жизнь становится примитивной «стрелялкой» в духе Doom, где не нужно думать, нужно только реагировать. Появляются «Тетраграмматон» (отсылка к "Эквилибриуму") и «Порт Скайрима».
*   **Action/RPG («Немота»):** «Веры прыжок между стогами».
    Отсылка к Assassin’s Creed. Но если в игре стог сена спасает жизнь, то здесь герой прыгает между стогами (на землю). Игровая механика ломается, приводя к смерти («Звук шлепка в широту пашни»).
*   **Game Over / Чит-коды («Авада Кедавра»):** «Жизнь — игра / Жизнь — не игрушки».
    В финале герой понимает, что он не игрок, а «курсор мыши», распятый на экране. Заклинание смерти «Авада Кедавра» — это, по сути, чит-код на выход из игры.

### Термодинамика Души: Холод vs Огонь

Сквозной образ температурного режима героя. Он никогда не находится в тепле (нормальном состоянии). Его бросает из озноба смерти в горячку боя.
*   **Холод (Смерть/Одиночество/Апатия):**
    *   «Жизнь»: «Мысли о лете с собой забирающих» (лето/тепло уходит вместе с жизнью, оставляя холод трупа).
    *   «Вольфрам»: «По колено в уснувшем аду» (ад замерз, стал обыденностью), «Светом на холостом ходу» (нет тепла от энергии).
    *   «Немота»: «Раскрасит градом белым розы» (холодное оружие/осадки), «Снег впитал их чужие улыбки» (смерть замораживает эмоции).
    *   «Man Overboard»: «Where nothing but the sea» (финальное погружение в ледяную воду небытия).
*   **Огонь (Уничтожение/Боль/Ярость):**
    *   «Вольфрам»: «Трясется пружинка вольфрама» (накал нити добела), «Глазами костра» (смотреть на мир через призму уничтожения).
    *   «Авада Кедавра»: «Пепел черный и пламя рыжее», «Чиркая злобой о бок коробка» (человек-спичка, который сгорает, чтобы на секунду дать свет).
    *   «Man Overboard»: «Crackling fire in garbage cans» (огонь на социальном дне, греющий бездомных).
*   **Точка слома (Попытка торга со стихией):**
    *   «Тест на репликанта»: «Подкупал Иван Купалу?».
    Это мощнейший образ. Иван Купала — древний праздник летнего солнцестояния, единственная мистическая точка, где Огонь (прыжки через костер) и Вода (купание) должны соединяться ради плодородия и Жизни.
    Но герой использует слово «Подкупал». Это попытка коррумпировать природу: вместо очищения огнем и водой персонажи пытаются дать взятку стихии, чтобы откупиться от грядущего хаоса. Сакральный огонь праздника превращается в криминальную сделку, которая не спасает.
    **Параллель:** Герой пытается согреться искусственным огнем войны и ритуалов («Авада Кедавра», «Иван Купала»), но взятка стихиям отвергнута, и в итоге он оказывается в ледяной воде («Man Overboard»).

### Временная петля: Автокатастрофа

Альбом представляет собой временную петлю (Time Loop). Финал альбома является причиной его начала.
*   **Финал («Man Overboard»):** Герой — «Drunk driver» (Пьяный водитель), вылетающий на «Opposite Lane» (встречную полосу). Происходит «Unplanned crash undertaking».
*   **Начало («Жизнь»):** Первый трек описывает последствия этой аварии, но глазами наблюдателя или жертвы: «Как тела абсолютно упруго стукаются... Через лобовые стёкла машин».
*   **Середина («Ангел жизни»):** Предвестник трагедии. «И шофёр слегка уснул». Герой на войне «засыпает» за рулем собственной судьбы, теряя контроль.

---

## Вердикт

Альбом **«Жизнь»** — это пугающе точный слепок современности. Это история о том, как человеческая душа, пропущенная через мясорубку истории, пытается сохранить себя, превращаясь в камень, металл и цифровой код, но в итоге находит покой только в падении.

Это «Божественная комедия» наоборот: герой не поднимается из Ада в Рай, а, начав с Чистилища жизни, добровольно ныряет в ледяной Коцит небытия, потому что даже Ад лучше, чем «немота» и «прорезиненный кумар» реальности. Шедевр мрачного экзистенциализма.

«Жизнь»представляет собой замкнутую структуру Уробороса (змеи, кусающей свой хвост), которая начинается с конца истории героя («Man Overboard»), а затем трек за треком показывает, как именно он дошел до этого состояния (через войну, потерю речи, безумие и попытки забыться в «играх» и «мороке»)

---

# Диптих Распада

## Анализ альбома «Volume 3: ЖИЗНЬ» в контексте «Volume 2»

Если Volume 2 — это острая фаза психоза, паническая атака на скорости 200 км/ч и попытка убежать от реальности через безумие, то Volume 3 — это хроническая стадия, тяжелая депрессия и похмелье после этой гонки.

Герой Volume 2 еще надеялся убежать (жал на газ, менял маски). Герой Volume 3 понял, что бежать некуда, потому что «мир мал, как тюрьма».

### 1. Связь Альбомов: Диалектика Безумия

Альбомы соотносятся как Причина и Следствие (или наоборот, как Следствие и Причина, учитывая временную петлю), а также как Внутреннее и Внешнее.

| Параметр | Volume 2 (Без названия) | Volume 3 (ЖИЗНЬ) |
| :--- | :--- | :--- |
| **Состояние** | **Мания и Психоз.** Горячка, скорость, агрессия. Герой — активный субъект (пусть и безумный), он за рулем. | **Депрессия и Кататония.** Апатия, холод, статика. Герой — объект (дерево, вольфрам, курсор), он функция или пассажир. |
| **Температура** | **Жар / Огонь.** «Оранжевый — любимый цвет», пожары, взрывы. Ад здесь горячий. | **Холод / Лед.** «Замерзший ад», «кипяток во фляге», «зимующие в Игоревом полку». Ад замерз. |
| **Враг** | **Внутренний Демон.** Тень («Черный челик»), двойники, галлюцинации. Борьба с самим собой. | **Система / Левиафан.** Государство («Мордор»), Война («Мукомольня»), История. Борьба с внешней средой. |
| **Финал** | **Цифровая Смерть.** Game Over, глитч, «кликнуть крестик». Смерть как выход из симуляции. | **Физическая Смерть.** «Человек за бортом», тонущий в ледяной воде. Смерть как биологический конец. |


### 2. Сюжетная Арка Диптиха: Петля Мёбиуса

Если соединить треклисты двух альбомов, мы получаем Уроборос — змею, кусающую свой хвост. История не линейна, она зациклена в моменте автокатастрофы.

**Точка Стыка: Авария**
*   **Vol. 2 (Финал):** В треке «В серость туманов» герой врезается в поребрик, разбивает лицо о стекло. В «Три четыре» его душа зависает в цифровом лимбе.
*   **Vol. 3 (Начало):** Трек «Жизнь» начинается с описания того, «как тела упруго стукаются через лобовые стекла».
*   **Связь:** Volume 3 — это то, что видит герой Volume 2 в ту самую секунду удара, растянутую в вечность. Вся «Жизнь» (Volume 3) проносится перед глазами умирающего водителя из Volume 2. Или наоборот: Volume 3 — это реальность, которая привела к безумной гонке Volume 2.

**Точка Стыка: Ребенок**
*   **Vol. 2:** Герой везет «трупик внутреннего ребенка» в клинику («Поющая могилка»). Он пытается спасти свою невинность. В финале («Три четыре») детский хор скандирует «Враг!», знаменуя смерть чистоты.
*   **Vol. 3:** Внутреннего ребенка больше нет. Есть только пушечное мясо.
    *   В «Ангеле жизни» — «четверо кутят на вписке» (циничное отношение к молодым солдатам).
    *   В «Вольно» — «передернул затвор школьник». Ребенок стал убийцей. Трансформация завершена. Попытка спасения из Vol. 2 провалилась.

### 3. Детальный анализ концепции Volume 3 через призму Volume 2

**А. От «Игры» к «Функции» (Эволюция Дегуманизации)**

*   В Vol. 2 герой спасался в геймификации: жизнь была «плохим сиквелом FEAR», он «ваншотил NPC». Он чувствовал себя Игроком.
*   В Vol. 3 (трек «Авада Кедавра») происходит страшное осознание: «Жизнь — игра, жизнь — не игрушки». Герой понимает, что он не Игрок, он — Курсор. Или Вольфрамовая нить. Он больше не управляет процессом, он стал инструментом в чужих руках.
*   **Связь:** Vol. 2 — иллюзия контроля через безумие. Vol. 3 — принятие отсутствия контроля и превращение в вещь.

**Б. Языковой коллапс: От Сленга к Немоте**

*   В Vol. 2 герой был болтлив. Он сыпал мемами, сленгом, агрессивно читал рэп, пытаясь заговорить страх («Недоверия раб», «Черный челик»).
*   В Vol. 3 наступает «Немота».
    «Рта врата мысли бодают / Не могу сказать ни слога».
    В «Вольфраме» — «кинопленки немого кино».
    В «Тесте на репликанта» — «хором глотка не орала».
*   **Связь:** Психика прошла стадию крика (Vol. 2) и вошла в стадию ступора (Vol. 3). Слов больше нет, потому что реальность стала неописуемой. Финальный переход на ломаный английский в «Man Overboard» — это окончательная капитуляция языка. Родная речь умерла.

**В. Религия: От насмешки к Военной Теократии**

*   В Vol. 2 герой иронизировал над Богом («Будда на гриле»), примерял на себя роль божества.
*   В Vol. 3 Бог становится страшным Генералом.
    «Ангел жизни»: «Тетраграмматон прекрасен» — Бог отдает приказы на зачистку.
    «Авада Кедавра»: «Евангелист-пулеметчик».
    «Немота»: «На дворе Мордор и Волан-де-Морт».
*   **Связь:** В безумии Vol. 2 Бог был внутренней галлюцинацией. В реальности Vol. 3 Бог — это внешняя тоталитарная сила, с которой невозможно договориться, можно только «подкупать Иван Купалу», но и это не работает.

### 4. Структура Volume 3: Анатомия Пост-Травмы

Альбом выстроен как Хроника пребывания в Чистилище, где герой медленно осознает, что он уже мертв (морально или физически).

1.  **Акт I: Осознание Травмы (Физиология)**
    *   «Жизнь» и «Вольно».
    *   Это пробуждение после аварии Vol. 2. Герой чувствует себя «деревом», которое тешет «столяр» (хирург или Бог). Боль возвращается. Иллюзии («охапка криволинейных») рассыпаются. Он понимает, что его «поймали» («Вольно» — команда в тюрьме/армии).
2.  **Акт II: Милитаризация Души (Принятие роли)**
    *   «Ангел жизни» и «Вольфрам».
    *   Герой Vol. 2, который бежал от войны, в Vol. 3 оказывается внутри неё. Он становится «Евангелистом-пулеметчиком». Он принимает правила игры: «Тетраграмматон прекрасен». Но его психика («пружинка вольфрама») не выдерживает напряжения. Он "светит" (убивает/живет) только потому, что через него пропускают тысячи вольт.
3.  **Акт III: Социальный Паралич (Ступор)**
    *   «Тест на репликанта» и «Немота».
    *   Попытка взаимодействия с обществом. Герой видит, что общество («спящий Игорев полк») находится в мороке. Диалог невозможен (силовик vs протестующий). Остается только «Немота» — полный отказ от коммуникации. Это зеркало трека «Черный челик» из Vol. 2, только там герой спорил с собой, а здесь он молчит перед лицом Левиафана.
4.  **Акт IV: Финал (Выход в открытое море)**
    *   «Авада Кедавра» и «Man Overboard».
    *   Круг замыкается. «Жизнь — не игрушки». Заклинание смерти (Авада Кедавра) произнесено.
    *   В «Man Overboard» герой Vol. 3 встречается с героем Vol. 2.
    *   Vol. 2: «Я в той машине, что сносит поребрик».
    *   Vol. 3: «Drunk driver... Opposite Lane... Unplanned crash undertaking».
    *   Это один и тот же момент. В Vol. 2 это был момент удара об асфальт. В Vol. 3 это момент падения в воду («Man Overboard»). Вода гасит огонь Vol. 2.

### 5. Итоговое Резюме: О чем на самом деле этот Диптих?

Volume 2 задал вопрос: «Что происходит с человеком, когда мир сходит с ума?»
Ответ был: «Он сходит с ума вместе с ним, пытаясь стать быстрее и жестче мира».
Volume 3 задает вопрос: «Что остается от человека, когда безумие проходит, а мир остается разрушенным?»

> **Ответ:** «Остается только Вольфрам (функция), Немота (бессилие) и неизбежное падение за борт».

Альбом «Жизнь» (Volume 3) парадоксальным образом описывает Смерть гораздо глубже, чем предыдущий альбом. Если Volume 2 был агонией, то Volume 3 — это трупное окоченение души.

Автор утверждает страшную истину:

**Единственный способ выжить в «Мордоре» (реальности Vol. 3) — это стать машиной (вольфрамом, столяром, ангелом смерти). Но становясь машиной, ты перестаешь жить. Поэтому финал — «Man Overboard» — это не трагедия, а освобождение. Это единственный способ выйти из бесконечного цикла насилия и «немоты», в который герой попал еще в первом треке второго альбома.**`;
    
    popup.innerHTML = `
        <div class="popup-content">
            <div class="popup-header">
                <h2>О чем этот альбом</h2>
                <button class="close-btn">×</button>
            </div>
            <div class="popup-body">
                <div class="markdown-content">${marked.parse(content)}</div>
            </div>
        </div>
    `;

    document.body.appendChild(popup);
    popup.querySelector('.close-btn').addEventListener('click', () => popup.remove());
    popup.addEventListener('click', (e) => { if (e.target === popup) popup.remove(); });
}

// ЭФФЕКТЫ (ВЕРНУЛ ЛОГИКУ)
function initializeSnowEffect() {
    const snowContainer = document.querySelector('.snowflakes');
    for (let i = 0; i < 50; i++) {
        const snowflake = document.createElement('div');
        snowflake.classList.add('snowflake');
        const size = Math.random() * 5 + 2;
        const posX = Math.random() * 100;
        const delay = Math.random() * 5;
        const duration = Math.random() * 10 + 5;
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        snowflake.style.left = `${posX}%`;
        snowflake.style.animationDelay = `${delay}s`;
        snowflake.style.animationDuration = `${duration}s`;
        snowContainer.appendChild(snowflake);
    }
}

function initializeMuzzleFlashes() {
    const muzzleFlashContainer = document.querySelector('.muzzle-flashes');
    setInterval(() => {
        const flashCount = Math.floor(Math.random() * 5) + 1;
        for (let i = 0; i < flashCount; i++) {
            const posX = Math.random() * 100;
            const posY = Math.random() * 100;
            const flash = document.createElement('div');
            flash.classList.add('muzzle-flash');
            flash.style.left = `${posX}%`;
            flash.style.top = `${posY}%`;
            const size = Math.random() * 3 + 2;
            flash.style.width = `${size}px`;
            flash.style.height = `${size}px`;
            muzzleFlashContainer.appendChild(flash);
            setTimeout(() => { if (flash.parentNode) flash.parentNode.removeChild(flash); }, 100);
        }
    }, 200);
}

function initializeTVStatic() {
    // Create a more performant version using CSS animations
    const staticContainer = document.getElementById('tv-static');
    
    // Use CSS animation instead of canvas for better performance
    staticContainer.style.position = 'fixed';
    staticContainer.style.top = '0';
    staticContainer.style.left = '0';
    staticContainer.style.width = '100%';
    staticContainer.style.height = '100%';
    staticContainer.style.pointerEvents = 'none';
    staticContainer.style.zIndex = '1000';
    staticContainer.style.opacity = '0.15';
    
    // Create a more visually appealing static effect using CSS
    staticContainer.style.background = 'radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(0,0,0,0.1) 100%)';
    staticContainer.style.animation = 'tvStaticNoise 0.05s infinite'; // Faster animation for more dynamic effect
    staticContainer.style.opacity = '0.25'; // Increase opacity
    
    // Add the CSS for the animation if it doesn't exist
    const style = document.createElement('style');
    style.textContent = `@keyframes tvStaticNoise {\n` +
        `    0%, 100% { \n` +
        `        background: \n` +
        `            radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(0,0,0,0.1) 100%),\n` +
        `            linear-gradient(rgba(255,255,255,0.15) 0 0) 0 0 / 2px 2px;\n` +
        `        opacity: 0.25;\n` +
        `    }\n` +
        `    25% { \n` +
        `        background: \n` +
        `            radial-gradient(circle, rgba(255,255,255,0.08) 0%, rgba(0,0,0,0.12) 100%),\n` +
        `            linear-gradient(rgba(255,255,255,0.12) 0 0) 1px 1px / 3px 3px;\n` +
        `        opacity: 0.22;\n` +
        `    }\n` +
        `    50% { \n` +
        `        background: \n` +
        `            radial-gradient(circle, rgba(255,255,255,0.15) 0%, rgba(0,0,0,0.08) 100%),\n` +
        `            linear-gradient(rgba(255,255,255,0.18) 0 0) 2px 2px / 4px 4px;\n` +
        `        opacity: 0.30;\n` +
        `    }\n` +
        `    75% { \n` +
        `        background: \n` +
        `            radial-gradient(circle, rgba(255,255,255,0.12) 0%, rgba(0,0,0,0.1) 100%),\n` +
        `            linear-gradient(rgba(255,255,255,0.1) 0 0) 0 0 / 5px 5px;\n` +
        `        opacity: 0.27;\n` +
        `    }\n` +
        `}`;
    document.head.appendChild(style);
}

function initializeTrackMenu() {
    const trackList = document.getElementById('track-list');
    const firstTrack = tracks[2];
    const firstLi = document.createElement('li');
    firstLi.textContent = firstTrack.title;
    firstLi.setAttribute('data-text', firstTrack.title);
    firstLi.dataset.trackId = firstTrack.id;
    firstLi.addEventListener('click', () => loadTrack(firstTrack));
    trackList.appendChild(firstLi);
    
    tracks.forEach((track, index) => {
        if (index !== 2) {
            const li = document.createElement('li');
            li.textContent = track.title;
            li.setAttribute('data-text', track.title);
            li.dataset.trackId = track.id;
            li.addEventListener('click', () => loadTrack(track));
            trackList.appendChild(li);
        }
    });
    
    // Добавляем элемент "о чем этот альбом" в конец списка треков
    const aboutAlbumLi = document.createElement('li');
    aboutAlbumLi.textContent = 'о чем этот альбом';
    aboutAlbumLi.setAttribute('data-text', 'о чем этот альбом');
    aboutAlbumLi.classList.add('about-album-item');
    aboutAlbumLi.addEventListener('click', showAlbumDescription);
    trackList.appendChild(aboutAlbumLi);
}

function loadTrack(track) {
    const audioPlayer = document.getElementById('track-player');
    audioPlayer.src = track.audioSrc;
    audioPlayer.load();
    audioPlayer.currentTime = 0;
    
    document.getElementById('track-img').src = track.imageSrc;
    document.getElementById('track-title').textContent = track.title;
    document.getElementById('song-lyrics').innerHTML = marked.parse(track.lyrics);
    document.getElementById('song-decoding').innerHTML = marked.parse(track.decoding);
    
    document.querySelectorAll('.track-menu li').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.trackId === track.id) {
            item.classList.add('active');
        }
    });
    
    const menu = document.getElementById('track-menu');
    if (window.innerWidth <= 768 && menu) {
        menu.classList.remove('menu-open');
    }
    
    setTimeout(() => { resetProgressBar(); }, 100);
    document.getElementById('play-btn').classList.remove('playing');
}